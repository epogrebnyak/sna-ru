<!DOCTYPE html>
<html>
<head>
<title>Handout</title>
<link rel="stylesheet" href="style.css">
<link rel="stylesheet" href="highlight.css">
<link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
<script src="marked.js"></script>
<script src="script.js"></script>
<script src="highlight.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [["$","$"]]}});</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script>
</head>
<body>
<article><div class="markdown"># System of national accounts (SNA)

Below is an end-to-end example of national accounts, processed
as pandas dataframe in python.

The data is for Russian Federation, 2014-2018.</div>
<pre><code class="python">import pandas as pd
import handout</code></pre>
<div class="markdown">We shall need to check identities with some rounding error.
Will use `eq` function for it.</div>
<pre><code class="python">def eq(df1: pd.DataFrame, df2: pd.DataFrame, precision=0.5) -&gt; bool:
    """Compare two dataframes by element with precision margin."""
    return ((df1 - df2).abs() &lt; precision).all()</code></pre>
<div class="markdown">Read dataset from file.</div>
<pre><code class="python">df = pd.read_csv("sna.csv", index_col=0)</code></pre>
<div class="markdown">Output at market prices is output at basic prices
plus tax on products less subsidy on products.</div>
<pre><code class="python">df["X"] = df.Xb + df.Tp - df.Sp</code></pre>
<div class="markdown">Output and import are resources,
consumption, investment (I) and export are uses.
Consumption is intermediate (AX) and final (C).</div>
<pre><code class="python">resources = df.X + df.IM
uses = df.AX + df.C + df.I + df.EX
assert eq(resources, uses + df.desc)</code></pre>
<div class="markdown">There are three ways to calculate a GDP.</div>
<pre><code class="python">gdp1 = df.X - df.AX
gdp2 = (df.C + df.I - df.IM) + df.EX + df.desc
gdp3 = df.W + df.Tf - df.Sf + df.GP

assert eq(gdp1, gdp2)
assert eq(gdp2, df.GDP)
assert eq(gdp3, df.GDP)</code></pre>
<div class="markdown">Gross national income (GNI) is GDP and
net property and labor ("factor") income
form rest of the world (ROW).</div>
<pre><code class="python">gni = (
    df.GDP
    + df.ROW_property_income_recieved
    - df.ROW_property_income_paid
    + df.ROW_wage_net
)
assert eq(gni.iloc[1:,], df.GNI.iloc[1:,])</code></pre>
<div class="markdown">Gross domestic income (GDI) is GNI
and net current (not capital) transfers</div>
<pre><code class="python">gdi = gni + df.CT_recieved - df.CT_paid
assert eq(gdi, df.GDI)
assert eq(df.C, df.HH + df.G)</code></pre>
<div class="markdown">Savings is gross domestic income
less household and government consumption</div>
<pre><code class="python">S = gdi - (df.HH + df.G)
assert eq(S, df.S)</code></pre>
<div class="markdown">Investment is gross fixed capital formation
and change in inventories.</div>
<pre><code class="python">I = df.GFCF + df.inv
assert eq(I, df.I)</code></pre>
<div class="markdown">Net lending is S-I, and a balance of capital transfers
and a non-produced non-material asset aquisition (K.2).</div>
<pre><code class="python">NL = S + df.d9_recieved - df.d9_paid - I - df.k2
assert eq(NL, df.NL0)</code></pre>
<div class="markdown">Net lending is an entry value into financial account (flow of funds).
Is contains a statistical error, later netted in flow of funds.</div>
<img src="res_use.png" width="100%" /></article>
</body>
</html>